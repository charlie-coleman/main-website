function LSystemConstruct(t,i,s,h,e,r,a,n,l,o){this.ctx=t,this.constants=i,this.orig_axiom=s,this.axiom=s,this.size=h,this.start_angle=e,this.curr_angle=e,this.angle=r,this.start_x=a,this.start_y=n,this.x=a,this.y=n,this.rules=l,this.draw_end=o||!1,this.i=0,this.created=!1,this.level=0,this.j=0,this.length=this.axiom.length,this.hold=this.axiom,this.hold_num=0,this.temp_x_arr=[],this.temp_y_arr=[],this.angle_arr=[],this.pos_arr=[],this.fin_angle_arr=[],this.rainbow=!0,this.h=0,this.s=.6,this.v=1,this.max_x=0,this.max_y=0,this.min_x=4096,this.min_y=4096,this.color_i=0,this.random_rules=!1,this.create=function(){this.ctx.moveTo(this.x,this.y),this.ctx.closePath()},this.draw=function(t){this.move_me(t,this.axiom[this.i])},this.move_me=function(t,i,s){if(s=s||!0,this.rainbow){this.color_i+=1,this.color_i>this.axiom.length&&(this.color_i=0);var h=this.HSVtoRGB(this.color_i/this.axiom.length,this.s,this.v);t.strokeStyle="rgb("+h.r+","+h.g+","+h.b+")"}s&&this.interp_letter_draw(i),this.x>this.max_x&&(this.max_x=this.x),this.y>this.max_y&&(this.max_y=this.y),this.x<this.min_x&&(this.min_x=this.x),this.y<this.min_y&&(this.min_y=this.y),t.lineTo(this.x,this.y),t.stroke(),t.beginPath(),t.closePath(),t.moveTo(this.x,this.y)},this.interp_letter_draw=function(t){if("+"==t)this.curr_angle+=this.angle;else if("-"==t)this.curr_angle-=this.angle;else if("["==t)this.temp_x_arr.push(this.x),this.temp_y_arr.push(this.y),this.angle_arr.push(this.curr_angle);else if("]"==t)this.curr_angle=this.angle_arr.pop(),this.x=this.temp_x_arr.pop(),this.y=this.temp_y_arr.pop(),this.ctx.moveTo(this.x,this.y);else if("F"==t){var i=this.curr_angle*Math.PI/180;Math.cos(i)*this.size,Math.sin(i)*this.size;this.x+=Math.cos(i)*this.size,this.y+=Math.sin(i)*this.size}this.pos_arr.push([this.x,this.y]),this.fin_angle_arr.push(this.curr_angle)},this.interp_letter=function(t){if("+"==t)return"+";if("-"==t)return"-";if("["==t)return"[";if("]"==t)return"]";for(var i=[],s=0;s<this.constants.length;s++)this.constants[s]==t&&i.push(s);return i.length>1&&(this.random_rules=!0),0!=i.length?this.rules[i[Math.floor(Math.random()*i.length)]]:void 0},this.create_string=function(t){if(0==this.j&&this.level<t&&(this.hold=this.axiom,this.hold_num=0,this.length=this.axiom.length),this.j<this.length&&this.level<t){var i=this.interp_letter(this.axiom[this.j])||"";this.hold=this.hold.splice(this.hold_num,1,i),this.hold_num=this.hold_num+i.length,this.j+=1}else this.j==this.length&&this.level<t?(this.axiom=this.hold,this.level+=1,this.hold_num=0,this.j=0):this.level==t&&(this.axiom=this.hold,this.level=t,this.draw_end?this.axiom=this.axiom.replace(/(A|B)/g,"F"):this.axiom=this.axiom.replace(/(A|B)/g,""),this.created=!0)},this.HSVtoRGB=function(t,i,s){var h,e,r,a,n,l,o,_;switch(1===arguments.length&&(i=t.s,s=t.v,t=t.h),a=Math.floor(6*t),n=6*t-a,l=s*(1-i),o=s*(1-n*i),_=s*(1-(1-n)*i),a%6){case 0:h=s,e=_,r=l;break;case 1:h=o,e=s,r=l;break;case 2:h=l,e=s,r=_;break;case 3:h=l,e=o,r=s;break;case 4:h=_,e=l,r=s;break;case 5:h=s,e=l,r=o}return{r:Math.round(255*h),g:Math.round(255*e),b:Math.round(255*r)}},this.reset=function(){this.i=0,this.curr_angle=this.start_angle,this.temp_x_arr=[],this.temp_y_arr=[],this.angle_arr=[],this.pos_arr=[],this.fin_angle_arr=[],this.color_i=0,this.max_x=0,this.max_y=0,this.min_x=4096,this.min_y=4096}}